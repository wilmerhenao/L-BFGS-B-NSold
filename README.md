Final Version of the code
